<!DOCTYPE html>
<html class="dark" lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Reset Password - MuscleMap</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script src="../tailwind-login.config.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet">

    <!-- Custom Styles -->
    <link href="../css/auth.css" rel="stylesheet">
    <style>
        .step-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 2rem;
        }

        .step {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
            color: #6b7280;
            font-weight: 600;
            position: relative;
        }

        .step.active {
            background: var(--primary-color, #ff6b35);
            color: white;
            box-shadow: 0 0 20px rgba(255, 107, 53, 0.5);
        }

        .step.completed {
            background: #10b981;
            color: white;
        }

        .step-line {
            width: 80px;
            height: 2px;
            background: rgba(255, 255, 255, 0.1);
            margin: 0 8px;
        }

        .step-line.active {
            background: var(--primary-color, #ff6b35);
        }

        .captcha-box {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 20px;
        }

        .captcha-text {
            font-family: 'Courier New', monospace;
            font-size: 28px;
            font-weight: bold;
            color: #fff;
            letter-spacing: 8px;
            user-select: none;
            text-decoration: line-through;
            text-decoration-color: rgba(255, 107, 53, 0.3);
            background: linear-gradient(45deg, #ff6b35, #e55a2a);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .otp-inputs {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-bottom: 24px;
        }

        .otp-input {
            width: 56px;
            height: 56px;
            text-align: center;
            font-size: 24px;
            font-weight: 700;
            border: 2px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.05);
            color: white;
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .otp-input:focus {
            outline: none;
            border-color: var(--primary-color, #ff6b35);
            box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.2);
        }

        .form-step {
            display: none;
        }

        .form-step.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body
    class="bg-background-light dark:bg-background-dark font-display text-white min-h-screen flex flex-col relative overflow-x-hidden selection:bg-primary selection:text-black">
    <!-- Background Effects -->
    <div class="fixed inset-0 z-0 pointer-events-none overflow-hidden">
        <div
            class="absolute top-0 left-1/4 w-[500px] h-[500px] bg-primary/10 rounded-full blur-[120px] mix-blend-screen opacity-20 animate-pulse">
        </div>
        <div
            class="absolute bottom-0 right-1/4 w-[600px] h-[600px] bg-emerald-500/10 rounded-full blur-[140px] mix-blend-screen opacity-20">
        </div>
        <div
            class="absolute inset-0 bg-[linear-gradient(rgba(255,255,255,0.02)_1px,transparent_1px),linear-gradient(90deg,rgba(255,255,255,0.02)_1px,transparent_1px)] bg-[size:4rem_4rem] [mask-image:radial-gradient(ellipse_60%_60%_at_50%_50%,#000_70%,transparent_100%)]">
        </div>
    </div>

    <main class="relative z-10 flex-grow flex items-center justify-center p-4 sm:p-6 lg:p-8">
        <div class="w-full max-w-[520px] flex flex-col gap-8 animate-fadeIn">
            <!-- Header -->
            <div class="text-center space-y-2">
                <div
                    class="inline-flex items-center justify-center w-12 h-12 rounded-xl bg-primary/10 border border-primary/20 mb-4 shadow-neon">
                    <span class="material-symbols-outlined text-primary" style="font-size: 28px;">lock_reset</span>
                </div>
                <h1 class="text-3xl md:text-4xl font-bold tracking-tight text-white">
                    Reset Your <span class="text-primary">Password</span>
                </h1>
                <p class="text-gray-400 text-sm md:text-base" id="stepDescription">
                    Enter your email address to get started.
                </p>
            </div>

            <!-- Step Indicator -->
            <div class="step-indicator">
                <div class="step active" id="step-1">1</div>
                <div class="step-line" id="line-1"></div>
                <div class="step" id="step-2">2</div>
                <div class="step-line" id="line-2"></div>
                <div class="step" id="step-3">3</div>
                <div class="step-line" id="line-3"></div>
                <div class="step" id="step-4">4</div>
            </div>

            <!-- Main Form -->
            <div class="glass-panel rounded-2xl p-6 md:p-8 shadow-2xl relative overflow-hidden">
                <div
                    class="absolute top-0 left-0 right-0 h-[1px] bg-gradient-to-r from-transparent via-primary/50 to-transparent opacity-50">
                </div>

                <form id="forgotPasswordForm">
                    <!-- Step 1: Email Input -->
                    <div class="form-step active" id="emailStep">
                        <div class="space-y-6">
                            <div class="space-y-2">
                                <label class="block text-xs font-semibold uppercase tracking-wider text-gray-400 ml-1">
                                    Email Address
                                </label>
                                <div class="relative group/input">
                                    <input
                                        class="input-glass w-full rounded-lg px-4 py-3.5 text-white placeholder-gray-500 focus:outline-none border-primary/50 shadow-neon pr-12"
                                        placeholder="name@example.com" type="email" id="resetEmail" required>
                                    <div
                                        class="absolute right-3.5 top-1/2 -translate-y-1/2 text-gray-500 flex items-center pointer-events-none">
                                        <span class="material-symbols-outlined" style="font-size: 24px;">mail</span>
                                    </div>
                                </div>
                                <span class="error-message text-red-400 text-sm"></span>
                            </div>

                            <button type="button" onclick="validateEmail()"
                                class="btn-primary w-full py-3.5 rounded-lg font-semibold">
                                Continue
                            </button>
                        </div>
                    </div>

                    <!-- Step 2: CAPTCHA Verification -->
                    <div class="form-step" id="captchaStep">
                        <div class="space-y-6">
                            <div class="space-y-2">
                                <label class="block text-xs font-semibold uppercase tracking-wider text-gray-400 ml-1">
                                    Verify You're Human
                                </label>

                                <div class="captcha-box">
                                    <div class="flex-1">
                                        <div class="captcha-text" id="captchaText">AB12CD</div>
                                    </div>
                                    <button type="button" onclick="generateCaptcha()"
                                        class="text-gray-400 hover:text-white transition-colors">
                                        <span class="material-symbols-outlined" style="font-size: 28px;">refresh</span>
                                    </button>
                                </div>

                                <input
                                    class="input-glass w-full rounded-lg px-4 py-3.5 text-white placeholder-gray-500 focus:outline-none"
                                    placeholder="Enter the code above" type="text" id="captchaInput" required>
                                <span class="error-message text-red-400 text-sm"></span>
                            </div>

                            <div class="flex gap-3">
                                <button type="button" onclick="goToStep(1)"
                                    class="btn-secondary flex-1 py-3.5 rounded-lg font-semibold">
                                    Back
                                </button>
                                <button type="button" onclick="validateCaptcha()"
                                    class="btn-primary flex-1 py-3.5 rounded-lg font-semibold">
                                    Verify & Continue
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: OTP Verification -->
                    <div class="form-step" id="otpStep">
                        <div class="space-y-6">
                            <div class="space-y-2">
                                <label
                                    class="block text-xs font-semibold uppercase tracking-wider text-gray-400 ml-1 text-center">
                                    Enter Verification Code
                                </label>
                                <p class="text-sm text-gray-400 text-center mb-4">
                                    We've sent a 6-digit code to <span id="emailDisplay"
                                        class="text-primary font-semibold"></span>
                                </p>

                                <div class="otp-inputs">
                                    <input type="text" maxlength="1" class="otp-input" id="otp1"
                                        oninput="moveToNext(this, 'otp2')"
                                        onkeydown="handleBackspace(event, null, 'otp2')">
                                    <input type="text" maxlength="1" class="otp-input" id="otp2"
                                        oninput="moveToNext(this, 'otp3')"
                                        onkeydown="handleBackspace(event, 'otp1', 'otp3')">
                                    <input type="text" maxlength="1" class="otp-input" id="otp3"
                                        oninput="moveToNext(this, 'otp4')"
                                        onkeydown="handleBackspace(event, 'otp2', 'otp4')">
                                    <input type="text" maxlength="1" class="otp-input" id="otp4"
                                        oninput="moveToNext(this, 'otp5')"
                                        onkeydown="handleBackspace(event, 'otp3', 'otp5')">
                                    <input type="text" maxlength="1" class="otp-input" id="otp5"
                                        oninput="moveToNext(this, 'otp6')"
                                        onkeydown="handleBackspace(event, 'otp4', 'otp6')">
                                    <input type="text" maxlength="1" class="otp-input" id="otp6"
                                        oninput="moveToNext(this, null)"
                                        onkeydown="handleBackspace(event, 'otp5', null)">
                                </div>
                                <span class="error-message text-red-400 text-sm text-center block"></span>

                                <div class="text-center mt-4">
                                    <button type="button" onclick="resendOTP()"
                                        class="text-sm text-gray-400 hover:text-primary transition-colors">
                                        Didn't receive code? <span class="text-primary font-semibold">Resend</span>
                                    </button>
                                </div>
                            </div>

                            <div class="flex gap-3">
                                <button type="button" onclick="goToStep(2)"
                                    class="btn-secondary flex-1 py-3.5 rounded-lg font-semibold">
                                    Back
                                </button>
                                <button type="button" onclick="validateOTP()"
                                    class="btn-primary flex-1 py-3.5 rounded-lg font-semibold">
                                    Verify Code
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Step 4: New Password -->
                    <div class="form-step" id="passwordStep">
                        <div class="space-y-6">
                            <div class="space-y-2">
                                <label class="block text-xs font-semibold uppercase tracking-wider text-gray-400 ml-1">
                                    New Password
                                </label>
                                <div class="relative group/input">
                                    <input
                                        class="input-glass w-full rounded-lg px-4 py-3.5 text-white placeholder-gray-500 focus:outline-none pr-12"
                                        placeholder="Enter new password" type="password" id="newPassword" required>
                                    <button
                                        class="absolute right-3.5 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-all"
                                        onclick="togglePasswordVisibility('newPassword', this)" type="button">
                                        <span class="material-symbols-outlined"
                                            style="font-size: 20px;">visibility_off</span>
                                    </button>
                                </div>
                                <span class="error-message text-red-400 text-sm"></span>

                                <!-- Password strength indicator -->
                                <div class="mt-2">
                                    <div class="flex gap-2">
                                        <div class="h-1 flex-1 rounded-full bg-gray-700" id="strength1"></div>
                                        <div class="h-1 flex-1 rounded-full bg-gray-700" id="strength2"></div>
                                        <div class="h-1 flex-1 rounded-full bg-gray-700" id="strength3"></div>
                                        <div class="h-1 flex-1 rounded-full bg-gray-700" id="strength4"></div>
                                    </div>
                                    <p class="text-xs text-gray-400 mt-1" id="strengthText">Password strength: Weak</p>
                                </div>
                            </div>

                            <div class="space-y-2">
                                <label class="block text-xs font-semibold uppercase tracking-wider text-gray-400 ml-1">
                                    Confirm Password
                                </label>
                                <div class="relative group/input">
                                    <input
                                        class="input-glass w-full rounded-lg px-4 py-3.5 text-white placeholder-gray-500 focus:outline-none pr-12"
                                        placeholder="Re-enter new password" type="password" id="confirmPassword"
                                        required>
                                    <button
                                        class="absolute right-3.5 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-all"
                                        onclick="togglePasswordVisibility('confirmPassword', this)" type="button">
                                        <span class="material-symbols-outlined"
                                            style="font-size: 20px;">visibility_off</span>
                                    </button>
                                </div>
                                <span class="error-message text-red-400 text-sm"></span>
                            </div>

                            <button type="button" onclick="resetPassword()"
                                class="btn-primary w-full py-3.5 rounded-lg font-semibold">
                                Reset Password
                            </button>
                        </div>
                    </div>
                </form>

                <!-- Back to Login -->
                <div class="text-center mt-6 pt-6 border-t border-white/10">
                    <a href="login.html" class="text-sm text-gray-400 hover:text-primary transition-colors">
                        ‚Üê Back to Login
                    </a>
                </div>
            </div>
        </div>
    </main>

    <script src="../js/forgot-password.js"></script>
</body>

</html>